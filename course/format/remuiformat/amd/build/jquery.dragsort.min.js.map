{"version":3,"sources":["jquery.dragsort.js"],"names":["define","$","fn","dragsort","options","opts","extend","defaults","lists","list","lastPos","this","each","i","cont","is","children","length","get","newList","draggedItem","placeHolderItem","pos","offset","offsetLimit","scroll","container","init","tagName","toLowerCase","itemSelector","dragSelector","placeHolderTemplate","attr","mousedown","grabItem","bind","uninit","styleDragHandlers","unbind","getItems","cursor","map","find","css","e","item","target","closest","insideMoveableItem","filter","which","dragSelectorExclude","preventDefault","dragHandle","parentNode","listElem","trigger","dragStart","call","mousemove","mouseup","dropItem","index","mt","parseInt","ml","top","pageY","isNaN","left","pageX","dragBetween","containerHeight","outerHeight","Math","max","round","outerWidth","right","bottom","h","height","w","width","clone","after","borderWidth","html","next","listTable","id","className","appendTo","append","orig","position","opacity","z-index","moveX","moveY","maxX","document","window","maxY","scrollY","setInterval","scrollContainer","t","scrollTop","scrollX","l","scrollLeft","createDropTargets","buildPositionTable","setPos","swapItems","wheel","x","y","min","parent","offsetParent","not","scrollSpeed","abs","originalEvent","clientX","clientY","deltaY","deltaMode","loc","elm","removeAttr","before","remove","clearInterval","dragEnd","apply","split","nextItem","eq","prepend","ei","findPos","nlist","fixed","idx","insertAfter","insertBefore","ph","dt","push","selector"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * jQuery List DragSort v0.5.2\n * Website: http://dragsort.codeplex.com/\n * License: http://dragsort.codeplex.com/license\n */\ndefine(['jquery'], function($) {\n    // (function($) {\n    $.fn.dragsort = function(options) {\n        if (options == \"destroy\") {\n            $(this.selector).trigger(\"dragsort-uninit\");\n            return;\n        }\n\n        var opts = $.extend({}, $.fn.dragsort.defaults, options);\n        var lists = [];\n        var list = null,\nlastPos = null;\n\n        this.each(function(i, cont) {\n\n            // If list container is table, the browser automatically wraps rows in tbody if not specified so change list container to tbody so that children returns rows as user expected\n            if ($(cont).is(\"table\") && $(cont).children().length == 1 && $(cont).children().is(\"tbody\")) {\n                cont = $(cont).children().get(0);\n            }\n\n            var newList = {\n                draggedItem: null,\n                placeHolderItem: null,\n                pos: null,\n                offset: null,\n                offsetLimit: null,\n                scroll: null,\n                container: cont,\n\n                init: function() {\n                    // Set options to default values if not set\n                    opts.tagName = $(this.container).children().length == 0 ? \"li\" : $(this.container).children().get(0).tagName.toLowerCase();\n                    if (opts.itemSelector == \"\") {\n                        opts.itemSelector = opts.tagName;\n                    }\n                    if (opts.dragSelector == \"\") {\n                        opts.dragSelector = opts.tagName;\n                    }\n                    if (opts.placeHolderTemplate == \"\") {\n                        opts.placeHolderTemplate = \"<\" + opts.tagName + \">&nbsp;</\" + opts.tagName + \">\";\n                    }\n\n                    // Listidx allows reference back to correct list variable instance\n                    $(this.container).attr(\"data-listidx\", i).mousedown(this.grabItem).bind(\"dragsort-uninit\", this.uninit);\n                    this.styleDragHandlers(true);\n                },\n\n                uninit: function() {\n                    var list = lists[$(this).attr(\"data-listidx\")];\n                    $(list.container).unbind(\"mousedown\", list.grabItem).unbind(\"dragsort-uninit\");\n                    list.styleDragHandlers(false);\n                },\n\n                getItems: function() {\n                    return $(this.container).children(opts.itemSelector);\n                },\n\n                styleDragHandlers: function(cursor) {\n                    this.getItems().map(function() {\n return $(this).is(opts.dragSelector) ? this : $(this).find(opts.dragSelector).get();\n}).css(\"cursor\", cursor ? \"pointer\" : \"\");\n                },\n\n                grabItem: function(e) {\n                    var list = lists[$(this).attr(\"data-listidx\")];\n                    var item = $(e.target).closest(\"[data-listidx] > \" + opts.tagName).get(0);\n                    var insideMoveableItem = list.getItems().filter(function() {\n return this == item;\n}).length > 0;\n\n                    // If not left click or if clicked on excluded element (e.g. text box) or not a moveable list item return\n                    if (e.which != 1 || $(e.target).is(opts.dragSelectorExclude) || $(e.target).closest(opts.dragSelectorExclude).length > 0 || !insideMoveableItem) {\n                        return;\n                    }\n\n                    // Prevents selection, stops issue on Fx where dragging hyperlink doesn't work and on IE where it triggers mousemove even though mouse hasn't moved,\n                    // does also stop being able to click text boxes hence dragging on text boxes by default is disabled in dragSelectorExclude\n                    e.preventDefault();\n\n                    // Change cursor to move while dragging\n                    var dragHandle = e.target;\n                    while (!$(dragHandle).is(opts.dragSelector)) {\n                        if (dragHandle == this) {\n return;\n                        }\n                        dragHandle = dragHandle.parentNode;\n                    }\n                    $(dragHandle).attr(\"data-cursor\", $(dragHandle).css(\"cursor\"));\n                    $(dragHandle).css(\"cursor\", \"move\");\n\n                    // On mousedown wait for movement of mouse before triggering dragsort script (dragStart) to allow clicking of hyperlinks to work\n                    var listElem = this;\n                    var trigger = function() {\n                        list.dragStart.call(listElem, e);\n                        $(list.container).unbind(\"mousemove\", trigger);\n                    };\n                    $(list.container).mousemove(trigger).mouseup(function() {\n $(list.container).unbind(\"mousemove\", trigger); $(dragHandle).css(\"cursor\", $(dragHandle).attr(\"data-cursor\"));\n});\n                },\n\n                dragStart: function(e) {\n                    if (list != null && list.draggedItem != null) {\n                        list.dropItem();\n                    }\n\n                    list = lists[$(this).attr(\"data-listidx\")];\n                    list.draggedItem = $(e.target).closest(\"[data-listidx] > \" + opts.tagName);\n\n                    // Record current position so on dragend we know if the dragged item changed position or not, not using getItems to allow dragsort to restore dragged item to original location in relation to fixed items\n                    list.draggedItem.attr(\"data-origpos\", $(this).attr(\"data-listidx\") + \"-\" + $(list.container).children().index(list.draggedItem));\n\n                    // Calculate mouse offset relative to draggedItem\n                    var mt = parseInt(list.draggedItem.css(\"marginTop\"));\n                    var ml = parseInt(list.draggedItem.css(\"marginLeft\"));\n                    list.offset = list.draggedItem.offset();\n                    list.offset.top = e.pageY - list.offset.top + (isNaN(mt) ? 0 : mt) - 1;\n                    list.offset.left = e.pageX - list.offset.left + (isNaN(ml) ? 0 : ml) - 1;\n\n                    // Calculate box the dragged item can't be dragged outside of\n                    if (!opts.dragBetween) {\n                        var containerHeight = $(list.container).outerHeight() == 0 ? Math.max(1, Math.round(0.5 + list.getItems().length * list.draggedItem.outerWidth() / $(list.container).outerWidth())) * list.draggedItem.outerHeight() : $(list.container).outerHeight();\n                        list.offsetLimit = $(list.container).offset();\n                        list.offsetLimit.right = list.offsetLimit.left + $(list.container).outerWidth() - list.draggedItem.outerWidth();\n                        list.offsetLimit.bottom = list.offsetLimit.top + containerHeight - list.draggedItem.outerHeight();\n                    }\n\n                    // Create placeholder item\n                    var h = list.draggedItem.height();\n                    var w = list.draggedItem.width();\n                    if (opts.tagName == \"tr\") {\n                        list.draggedItem.children().each(function() {\n $(this).width($(this).width());\n});\n                        list.placeHolderItem = list.draggedItem.clone().attr(\"data-placeholder\", true);\n                        list.draggedItem.after(list.placeHolderItem);\n                        list.placeHolderItem.children().each(function() {\n $(this).css({borderWidth: 0, width: $(this).width() + 1, height: $(this).height() + 1}).html(\"&nbsp;\");\n});\n                    } else {\n                        list.draggedItem.after(opts.placeHolderTemplate);\n                        list.placeHolderItem = list.draggedItem.next().css({height: h, width: w}).attr(\"data-placeholder\", true);\n                    }\n\n                    if (opts.tagName == \"td\") {\n                        var listTable = list.draggedItem.closest(\"table\").get(0);\n                        $(\"<table id='\" + listTable.id + \"' style='border-width: 0px;' class='dragSortItem \" + listTable.className + \"'><tr></tr></table>\").appendTo(\"body\").children().append(list.draggedItem);\n                    }\n\n                    // Style draggedItem while dragging\n                    var orig = list.draggedItem.attr(\"style\");\n                    list.draggedItem.attr(\"data-origstyle\", orig ? orig : \"\");\n                    list.draggedItem.css({position: \"absolute\", opacity: 0.8, \"z-index\": 999, height: h, width: w});\n\n                    // Auto-scroll setup\n                    list.scroll = {moveX: 0, moveY: 0, maxX: $(document).width() - $(window).width(), maxY: $(document).height() - $(window).height()};\n                    list.scroll.scrollY = window.setInterval(function() {\n                        if (opts.scrollContainer != window) {\n                            $(opts.scrollContainer).scrollTop($(opts.scrollContainer).scrollTop() + list.scroll.moveY);\n                            return;\n                        }\n                        var t = $(opts.scrollContainer).scrollTop();\n                        if (list.scroll.moveY > 0 && t < list.scroll.maxY || list.scroll.moveY < 0 && t > 0) {\n                            $(opts.scrollContainer).scrollTop(t + list.scroll.moveY);\n                            list.draggedItem.css(\"top\", list.draggedItem.offset().top + list.scroll.moveY + 1);\n                        }\n                    }, 10);\n                    list.scroll.scrollX = window.setInterval(function() {\n                        if (opts.scrollContainer != window) {\n                            $(opts.scrollContainer).scrollLeft($(opts.scrollContainer).scrollLeft() + list.scroll.moveX);\n                            return;\n                        }\n                        var l = $(opts.scrollContainer).scrollLeft();\n                        if (list.scroll.moveX > 0 && l < list.scroll.maxX || list.scroll.moveX < 0 && l > 0) {\n                            $(opts.scrollContainer).scrollLeft(l + list.scroll.moveX);\n                            list.draggedItem.css(\"left\", list.draggedItem.offset().left + list.scroll.moveX + 1);\n                        }\n                    }, 10);\n\n                    // Misc\n                    $(lists).each(function(i, l) {\n l.createDropTargets(); l.buildPositionTable();\n});\n                    list.setPos(e.pageX, e.pageY);\n                    $(document).bind(\"mousemove\", list.swapItems);\n                    $(document).bind(\"mouseup\", list.dropItem);\n                    if (opts.scrollContainer != window) {\n                        $(window).bind(\"wheel\", list.wheel);\n                    }\n                },\n\n                // Set position of draggedItem\n                setPos: function(x, y) {\n                    // Remove mouse offset so mouse cursor remains in same place on draggedItem instead of top left corner\n                    var top = y - this.offset.top;\n                    var left = x - this.offset.left;\n\n                    // Limit top, left to within box draggedItem can't be dragged outside of\n                    if (!opts.dragBetween) {\n                        top = Math.min(this.offsetLimit.bottom, Math.max(top, this.offsetLimit.top));\n                        left = Math.min(this.offsetLimit.right, Math.max(left, this.offsetLimit.left));\n                    }\n\n                    // Adjust top & left calculations to parent offset\n                    var parent = this.draggedItem.offsetParent().not(\"body\").offset(); // OffsetParent returns body even when it's static, if not static offset is only factoring margin\n                    if (parent != null) {\n                        top -= parent.top;\n                        left -= parent.left;\n                    }\n\n                    // Set x or y auto-scroll amount\n                    if (opts.scrollContainer == window) {\n                        y -= $(window).scrollTop();\n                        x -= $(window).scrollLeft();\n                        y = Math.max(0, y - $(window).height() + 5) + Math.min(0, y - 5);\n                        x = Math.max(0, x - $(window).width() + 5) + Math.min(0, x - 5);\n                    } else {\n                        var cont = $(opts.scrollContainer);\n                        var offset = cont.offset();\n                        y = Math.max(0, y - cont.height() - offset.top) + Math.min(0, y - offset.top);\n                        x = Math.max(0, x - cont.width() - offset.left) + Math.min(0, x - offset.left);\n                    }\n\n                    list.scroll.moveX = x == 0 ? 0 : x * opts.scrollSpeed / Math.abs(x);\n                    list.scroll.moveY = y == 0 ? 0 : y * opts.scrollSpeed / Math.abs(y);\n\n                    // Move draggedItem to new mouse cursor location\n                    this.draggedItem.css({top: top, left: left});\n                },\n\n                // If scroll container is a div allow mouse wheel to scroll div instead of window when mouse is hovering over\n                wheel: function(e) {\n                    if (list && opts.scrollContainer != window) {\n                        var cont = $(opts.scrollContainer);\n                        var offset = cont.offset();\n                        e = e.originalEvent;\n                        if (e.clientX > offset.left && e.clientX < offset.left + cont.width() && e.clientY > offset.top && e.clientY < offset.top + cont.height()) {\n                            var deltaY = (e.deltaMode == 0 ? 1 : 10) * e.deltaY;\n                            cont.scrollTop(cont.scrollTop() + deltaY);\n                            e.preventDefault();\n                        }\n                    }\n                },\n\n                // Build a table recording all the positions of the moveable list items\n                buildPositionTable: function() {\n                    var pos = [];\n                    this.getItems().not([list.draggedItem[0], list.placeHolderItem[0]]).each(function(i) {\n                        var loc = $(this).offset();\n                        loc.right = loc.left + $(this).outerWidth();\n                        loc.bottom = loc.top + $(this).outerHeight();\n                        loc.elm = this;\n                        pos[i] = loc;\n                    });\n                    this.pos = pos;\n                },\n\n                dropItem: function() {\n                    if (list.draggedItem == null) {\n                        return;\n                    }\n\n                    // List.draggedItem.attr(\"style\", \"\") doesn't work on IE8 and jQuery 1.5 or lower\n                    // list.draggedItem.removeAttr(\"style\") doesn't work on chrome and jQuery 1.6 (works jQuery 1.5 or lower)\n                    var orig = list.draggedItem.attr(\"data-origstyle\");\n                    list.draggedItem.attr(\"style\", orig);\n                    if (orig == \"\") {\n                        list.draggedItem.removeAttr(\"style\");\n                    }\n                    list.draggedItem.removeAttr(\"data-origstyle\");\n\n                    list.styleDragHandlers(true);\n\n                    list.placeHolderItem.before(list.draggedItem);\n                    list.placeHolderItem.remove();\n\n                    $(\"[data-droptarget], .dragSortItem\").remove();\n\n                    window.clearInterval(list.scroll.scrollY);\n                    window.clearInterval(list.scroll.scrollX);\n\n                    // If position changed call dragEnd\n                    if (list.draggedItem.attr(\"data-origpos\") != $(lists).index(list) + \"-\" + $(list.container).children().index(list.draggedItem)) {\n                        if (opts.dragEnd.apply(list.draggedItem) == false) { // If dragEnd returns false revert order\n                            var pos = list.draggedItem.attr(\"data-origpos\").split('-');\n                            var nextItem = $(lists[pos[0]].container).children().not(list.draggedItem).eq(pos[1]);\n                            if (nextItem.length > 0) {\n                                nextItem.before(list.draggedItem);\n                            } else if (pos[1] == 0) { // Was the only item in list\n                                $(lists[pos[0]].container).prepend(list.draggedItem);\n                            } else { // Was the last item in list\n                                $(lists[pos[0]].container).append(list.draggedItem);\n                            }\n                        }\n                    }\n                    list.draggedItem.removeAttr(\"data-origpos\");\n\n                    list.draggedItem = null;\n                    $(document).unbind(\"mousemove\", list.swapItems);\n                    $(document).unbind(\"mouseup\", list.dropItem);\n                    if (opts.scrollContainer != window) {\n                        $(window).unbind(\"wheel\", list.wheel);\n                    }\n                    return false;\n                },\n\n                // Swap the draggedItem (represented visually by placeholder) with the list item the it has been dragged on top of\n                swapItems: function(e) {\n                    if (list.draggedItem == null) {\n                        return false;\n                    }\n\n                    // Move draggedItem to mouse location\n                    list.setPos(e.pageX, e.pageY);\n\n                    // Retrieve list and item position mouse cursor is over\n                    var ei = list.findPos(e.pageX, e.pageY);\n                    var nlist = list;\n                    for (var i = 0; ei == -1 && opts.dragBetween && i < lists.length; i++) {\n                        ei = lists[i].findPos(e.pageX, e.pageY);\n                        nlist = lists[i];\n                    }\n\n                    // If not over another moveable list item return\n                    if (ei == -1) {\n                        return false;\n                    }\n\n                    // Save fixed items locations\n                    var children = function() {\n return $(nlist.container).children().not(nlist.draggedItem);\n};\n                    var fixed = children().not(opts.itemSelector).each(function(i) {\n this.idx = children().index(this);\n});\n\n                    // If moving draggedItem up or left place placeHolder before list item the dragged item is hovering over otherwise place it after\n                    if (lastPos == null || lastPos.top > list.draggedItem.offset().top || lastPos.left > list.draggedItem.offset().left) {\n                        $(nlist.pos[ei].elm).before(list.placeHolderItem);\n                    } else {\n                        $(nlist.pos[ei].elm).after(list.placeHolderItem);\n                    }\n\n                    // Restore fixed items location\n                    fixed.each(function() {\n                        var elm = children().eq(this.idx).get(0);\n                        if (this != elm && children().index(this) < this.idx) {\n                            $(this).insertAfter(elm);\n                        } else if (this != elm) {\n                            $(this).insertBefore(elm);\n                        }\n                    });\n\n                    // Misc\n                    $(lists).each(function(i, l) {\n l.createDropTargets(); l.buildPositionTable();\n});\n                    lastPos = list.draggedItem.offset();\n                    return false;\n                },\n\n                // Returns the index of the list item the mouse is over\n                findPos: function(x, y) {\n                    for (var i = 0; i < this.pos.length; i++) {\n                        if (this.pos[i].left < x && this.pos[i].right > x && this.pos[i].top < y && this.pos[i].bottom > y) {\n                            return i;\n                        }\n                    }\n                    return -1;\n                },\n\n                // Create drop targets which are placeholders at the end of other lists to allow dragging straight to the last position\n                createDropTargets: function() {\n                    if (!opts.dragBetween) {\n                        return;\n                    }\n\n                    $(lists).each(function() {\n                        var ph = $(this.container).find(\"[data-placeholder]\");\n                        var dt = $(this.container).find(\"[data-droptarget]\");\n                        if (ph.length > 0 && dt.length > 0) {\n                            dt.remove();\n                        } else if (ph.length == 0 && dt.length == 0) {\n                            if (opts.tagName == \"td\") {\n                                $(opts.placeHolderTemplate).attr(\"data-droptarget\", true).appendTo(this.container);\n                            } else {\n                                // List.placeHolderItem.clone().removeAttr(\"data-placeholder\") crashes in IE7 and jquery 1.5.1 (doesn't in jquery 1.4.2 or IE8)\n                                $(this.container).append(list.placeHolderItem.removeAttr(\"data-placeholder\").clone().attr(\"data-droptarget\", true));\n                            }\n\n                            list.placeHolderItem.attr(\"data-placeholder\", true);\n                        }\n                    });\n                }\n            };\n\n            newList.init();\n            lists.push(newList);\n        });\n\n        return this;\n    };\n\n    $.fn.dragsort.defaults = {\n        itemSelector: \"\",\n        dragSelector: \"\",\n        dragSelectorExclude: \"input, textarea\",\n        dragEnd: function() { },\n        dragBetween: false,\n        placeHolderTemplate: \"\",\n        scrollContainer: window,\n        scrollSpeed: 5\n    };\n\n    // })(jQuery);\n});\n"],"file":"jquery.dragsort.min.js"}